# üéØ –û–ë–†–ê–ë–û–¢–ß–ò–ö –ö–û–ú–ê–ù–î–´ /START ‚Äî –ü–û–õ–ù–´–ô –ì–ê–ô–î

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–ª—è –∫–æ–≥–æ:** –î–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ö–æ—á–µ—Ç –ø–æ–Ω—è—Ç—å –∫–∞–∫ –±–æ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—ã  
**–°—Ç–∏–ª—å:** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ, —Å –º–∞—Ç–æ–º, —é–º–æ—Ä–æ–º –∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ—á–∫–∏

---

## üéØ –ß–¢–û –ú–´ –î–ï–õ–ê–ï–ú

–°–æ–∑–¥–∞—ë–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã `/start`, –∫–æ—Ç–æ—Ä—ã–π:
- **–ü—Ä–∏–Ω–∏–º–∞–µ—Ç** –∫–æ–º–∞–Ω–¥—É `/start` –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **–†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–∏—Å—Ç–µ–º–µ (—á–µ—Ä–µ–∑ `UserService`)
- **–û—Ç–≤–µ—á–∞–µ—Ç** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º

**–ü—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏:**  
–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç `/start` –±–æ—Ç—É, –±–æ—Ç –¥–æ–ª–∂–µ–Ω:
1. –£–∑–Ω–∞—Ç—å –∫—Ç–æ —ç—Ç–æ (Telegram ID, –∏–º—è)
2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î (–µ—Å–ª–∏ –µ—â–µ –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω)
3. –ù–∞–ø–∏—Å–∞—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

---

## üìä –ê–†–•–ò–¢–ï–ö–¢–£–†–ê: –ö–ê–ö –ë–û–¢ –û–ë–†–ê–ë–ê–¢–´–í–ê–ï–¢ –ö–û–ú–ê–ù–î–´

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ Telegram
    ‚îÇ
    ‚ñº
–ù–∞–∂–∏–º–∞–µ—Ç /start
    ‚îÇ
    ‚ñº
Telegram –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç Update –±–æ—Ç—É
    ‚îÇ
    ‚ñº
Bot.onUpdateReceived(Update update)  ‚Üê "–ü–æ–ª—É—á–µ–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ!"
    ‚îÇ
    ‚ñº
–ü—Ä–æ–≤–µ—Ä—è–µ–º: —ç—Ç–æ –∫–æ–º–∞–Ω–¥–∞? (/start?)
    ‚îÇ
    ‚ñº
StartCommandHandler.handle(Update update)  ‚Üê "–û–±—Ä–∞–±–æ—Ç–∞–π –∫–æ–º–∞–Ω–¥—É!"
    ‚îÇ
    ‚ñº
UserService.registerUser(...)  ‚Üê "–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è!"
    ‚îÇ
    ‚ñº
UserRepository.save(...)  ‚Üê "–°–æ—Ö—Ä–∞–Ω–∏ –≤ –ë–î!"
    ‚îÇ
    ‚ñº
–ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é  ‚Üê "–ü—Ä–∏–≤–µ—Ç! –¢—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω!"
```

---

## üîß –ß–¢–û –¢–ê–ö–û–ï HANDLER (–û–ë–†–ê–ë–û–¢–ß–ò–ö)

### –ê–Ω–∞–ª–æ–≥–∏—è –∏–∑ –∂–∏–∑–Ω–∏:

**Handler** ‚Äî —ç—Ç–æ –∫–∞–∫ **–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç –≤ –º–∞–≥–∞–∑–∏–Ω–µ**, –∫–æ—Ç–æ—Ä—ã–π —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –æ–¥–Ω–æ–π –∑–∞–¥–∞—á–µ.

- **–ö–ª–∏–µ–Ω—Ç:** "–ú–Ω–µ –Ω—É–∂–µ–Ω —Ç–µ–ª–µ—Ñ–æ–Ω!"
- **–ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç (Handler):** "–û–∫, —è —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Å—å –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞—Ö. –°–µ–π—á–∞—Å –ø–æ–∫–∞–∂—É —Ç–µ–±–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã!"
- **–î—Ä—É–≥–æ–π –∫–ª–∏–µ–Ω—Ç:** "–ú–Ω–µ –Ω—É–∂–Ω–∞ –∫—É—Ä—Ç–∫–∞!"
- **–î—Ä—É–≥–æ–π –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç (–î—Ä—É–≥–æ–π Handler):** "–û–∫, —è —Ä–∞–±–æ—Ç–∞—é —Å –∫—É—Ä—Ç–∫–∞–º–∏!"

**–í –Ω–∞—à–µ–º –±–æ—Ç–µ:**
- `StartCommandHandler` ‚Äî –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É `/start`
- `HelpCommandHandler` (–ø–æ–∑–∂–µ) ‚Äî –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É `/help`
- `OrderHandler` (–ø–æ–∑–∂–µ) ‚Äî –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤

**–ë–µ–∑ Handler:**
```java
// –í—Å—ë –≤ –æ–¥–Ω–æ–º –º–µ—Ç–æ–¥–µ Bot.onUpdateReceived (–ø–ª–æ—Ö–æ!)
@Override
public void onUpdateReceived(Update update) {
    if (update.hasMessage() && update.getMessage().getText().equals("/start")) {
        // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...
        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è...
    }
    if (update.hasMessage() && update.getMessage().getText().equals("/help")) {
        // –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ–º–æ—â–∏...
    }
    // ... 100 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ –≤ –æ–¥–Ω–æ–º –º–µ—Ç–æ–¥–µ (–±–∞—Ä–¥–∞–∫!)
}
```

**–° Handler:**
```java
// Bot.onUpdateReceived –¥–µ–ª–µ–≥–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É
@Override
public void onUpdateReceived(Update update) {
    if (update.hasMessage() && update.getMessage().getText().equals("/start")) {
        startCommandHandler.handle(update);  // –û—Ç–¥–∞—ë–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫—É
    }
}

// StartCommandHandler.handle ‚Äî –≤—Å—è –ª–æ–≥–∏–∫–∞ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
public void handle(Update update) {
    // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è + –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
}
```

**–ö–∞–∂–¥—ã–π Handler –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–≤–æ—é –∑–∞–¥–∞—á—É ‚Äî –ø–æ—Ä—è–¥–æ–∫!**

---

## üìù –û–ë–™–ï–ö–¢ Update ‚Äî –ß–¢–û –≠–¢–û –¢–ê–ö–û–ï

`Update` ‚Äî —ç—Ç–æ –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç **–í–°–Æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é** –æ —Å–æ–±—ã—Ç–∏–∏ –≤ Telegram.

### –ß—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ Update:

1. **–°–æ–æ–±—â–µ–Ω–∏–µ** (`update.getMessage()`) ‚Äî —Ç–µ–∫—Å—Ç, —Ñ–æ—Ç–æ, –¥–æ–∫—É–º–µ–Ω—Ç
2. **–ö–æ–º–∞–Ω–¥–∞** (`/start`, `/help`) ‚Äî —Ç–æ–∂–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –Ω–æ —Å `/` –≤ –Ω–∞—á–∞–ª–µ
3. **Callback** (`update.getCallbackQuery()`) ‚Äî –Ω–∞–∂–∞—Ç–∏–µ –Ω–∞ –∫–Ω–æ–ø–∫—É
4. **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** (`update.getEditedMessage()`) ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–ª —Å–æ–æ–±—â–µ–Ω–∏–µ

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Update:

```java
Update update = {
    message: {
        messageId: 123,
        from: {
            id: 123456789L,  // ‚Üê –≠–¢–û –ù–ê–ú –ù–£–ñ–ù–û! Telegram ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            firstName: "–ò–≤–∞–Ω",
            lastName: "–ò–≤–∞–Ω–æ–≤",
            username: "ivan_ivanov"
        },
        chat: {
            id: 123456789L,  // ID —á–∞—Ç–∞
            type: "private"  // –õ–∏—á–Ω—ã–π —á–∞—Ç
        },
        text: "/start",  // ‚Üê –≠–¢–û –ù–ê–ú –ù–£–ñ–ù–û! –¢–µ–∫—Å—Ç –∫–æ–º–∞–Ω–¥—ã
        date: 1640000000
    }
}
```

**–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ:**
```java
Long telegramId = update.getMessage().getFrom().getId();  // Telegram ID
String fullName = update.getMessage().getFrom().getFirstName() + " " + 
                  update.getMessage().getFrom().getLastName();  // –ò–º—è
String text = update.getMessage().getText();  // –¢–µ–∫—Å—Ç –∫–æ–º–∞–Ω–¥—ã
```

---

## üéØ –ê–ù–ù–û–¢–ê–¶–ò–ò –ò –ö–õ–ê–°–°–´

### `@Component` ‚Äî "–≠—Ç–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç Spring!"

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**  
–ì–æ–≤–æ—Ä–∏—Ç Spring: "–°–æ–∑–¥–∞–π –±–∏–Ω –¥–ª—è —ç—Ç–æ–≥–æ –∫–ª–∞—Å—Å–∞ –∏ –∏–Ω–∂–µ–∫—Ç–∏—Ä—É–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏!"

**–ü—Ä–∏–º–µ—Ä:**
```java
@Component
public class StartCommandHandler {
    // ...
}
```

**–ó–∞—á–µ–º:**  
–ß—Ç–æ–±—ã Spring –º–æ–≥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç `StartCommandHandler` –∏ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç—å `UserService` —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä (Dependency Injection).

---

### `@RequiredArgsConstructor` ‚Äî "–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Å final –ø–æ–ª—è–º–∏"

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**  
Lombok —Å–æ–∑–¥–∞—ë—Ç –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Å–æ –≤—Å–µ–º–∏ `final` –ø–æ–ª—è–º–∏.

**–ü—Ä–∏–º–µ—Ä:**
```java
@Component
@RequiredArgsConstructor
public class StartCommandHandler {
    private final UserService userService;  // Spring –ø–æ–¥—Å—Ç–∞–≤–∏—Ç —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä
    private final TelegramLongPollingBot bot;  // Spring –ø–æ–¥—Å—Ç–∞–≤–∏—Ç –±–æ—Ç–∞
}
```

**–ë–µ–∑ `@RequiredArgsConstructor`:**
```java
public StartCommandHandler(UserService userService, TelegramLongPollingBot bot) {
    this.userService = userService;
    this.bot = bot;
}
```

---

### `@Slf4j` ‚Äî "–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ"

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**  
Lombok –¥–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª–µ `log` –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è.

**–ü—Ä–∏–º–µ—Ä:**
```java
@Slf4j
public class StartCommandHandler {
    public void handle(Update update) {
        log.info("–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã /start –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {}", 
                 update.getMessage().getFrom().getId());
    }
}
```

---

## üì® –ö–ê–ö –û–¢–ü–†–ê–í–ò–¢–¨ –°–û–û–ë–©–ï–ù–ò–ï –ë–û–¢–£

### –ö–ª–∞—Å—Å `SendMessage`:

`SendMessage` ‚Äî —ç—Ç–æ –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ–æ–±—â–µ–Ω–∏–∏, –∫–æ—Ç–æ—Ä–æ–µ –±–æ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç.

**–ü–æ–ª—è:**
- `chatId` ‚Äî ID —á–∞—Ç–∞ (–∫—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å)
- `text` ‚Äî —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
- `parseMode` ‚Äî —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (HTML, Markdown)
- `replyMarkup` ‚Äî –∫–Ω–æ–ø–∫–∏ (–ø–æ–∑–∂–µ)

**–ü—Ä–∏–º–µ—Ä:**
```java
SendMessage message = new SendMessage();
message.setChatId(chatId.toString());  // –ö—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å
message.setText("–ü—Ä–∏–≤–µ—Ç! –¢—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω!");  // –ß—Ç–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å

// –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —á–µ—Ä–µ–∑ –±–æ—Ç–∞
bot.execute(message);
```

**–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å—Ç–∏–ª—å (—á–µ—Ä–µ–∑ builder):**
```java
SendMessage message = SendMessage.builder()
    .chatId(chatId.toString())
    .text("–ü—Ä–∏–≤–µ—Ç! –¢—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω!")
    .build();

bot.execute(message);
```

---

## üö® –û–ë–†–ê–ë–û–¢–ö–ê –û–®–ò–ë–û–ö

### –ß—Ç–æ –º–æ–∂–µ—Ç –ø–æ–π—Ç–∏ –Ω–µ —Ç–∞–∫:

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω** ‚Äî `UserService.registerUser()` –≤—ã–±—Ä–æ—Å–∏—Ç `IllegalArgumentException`
2. **–ë–î –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞** ‚Äî `UserRepository` –≤—ã–±—Ä–æ—Å–∏—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ
3. **Telegram API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω** ‚Äî `bot.execute()` –≤—ã–±—Ä–æ—Å–∏—Ç `TelegramApiException`

**–ö–∞–∫ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å:**
```java
try {
    userService.registerUser(telegramId, fullName);
} catch (IllegalArgumentException e) {
    // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω ‚Äî –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞, –ø—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
    log.debug("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω: {}", telegramId);
} catch (Exception e) {
    // –°–µ—Ä—å—ë–∑–Ω–∞—è –æ—à–∏–±–∫–∞ ‚Äî –ª–æ–≥–∏—Ä—É–µ–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
    log.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {}", telegramId, e);
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
}
```

---

## üìã –ü–û–õ–ù–´–ô –ö–û–î StartCommandHandler

–í–æ—Ç –∫–∞–∫ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –ø–æ–ª–Ω—ã–π –∫–ª–∞—Å—Å `StartCommandHandler`:

```java
package org.example.flower_delivery.handler;

import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.example.flower_delivery.Bot;
import org.example.flower_delivery.service.UserService;
import org.springframework.stereotype.Component;
import org.telegram.telegrambots.meta.api.methods.send.SendMessage;
import org.telegram.telegrambots.meta.api.objects.Message;
import org.telegram.telegrambots.meta.api.objects.Update;
import org.telegram.telegrambots.meta.exceptions.TelegramApiException;

/**
 * –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start
 * 
 * <h2>–ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ:</h2>
 * Handler –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É /start –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
 * - –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–∏—Å—Ç–µ–º–µ (—á–µ—Ä–µ–∑ UserService)
 * - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
 * 
 * <h2>–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:</h2>
 * <ol>
 *   <li><b>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</b> –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—É /start</li>
 *   <li><b>Bot.onUpdateReceived</b> –ø–æ–ª—É—á–∞–µ—Ç Update –∏ –≤—ã–∑—ã–≤–∞–µ—Ç handler.handle()</li>
 *   <li><b>Handler</b> –∏–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (Telegram ID, –∏–º—è)</li>
 *   <li><b>Handler</b> –≤—ã–∑—ã–≤–∞–µ—Ç userService.registerUser() –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</li>
 *   <li><b>Handler</b> –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ bot.execute()</li>
 * </ol>
 * 
 * <h2>–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:</h2>
 * 
 * <h3>–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã /start:</h3>
 * <pre>{@code
 * Update update = ...;  // Update –æ—Ç Telegram
 * startCommandHandler.handle(update);
 * }</pre>
 * 
 * @author –ò–ª–∞—Ä–∏–æ–Ω
 * @version 1.0
 * @see org.example.flower_delivery.service.UserService
 * @see org.example.flower_delivery.Bot
 */
@Component  // –ì–æ–≤–æ—Ä–∏—Ç Spring: "–≠—Ç–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, —Å–æ–∑–¥–∞–π –¥–ª—è –Ω–µ–≥–æ –±–∏–Ω!"
@RequiredArgsConstructor  // Lombok: —Å–æ–∑–¥–∞—Å—Ç –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Å–æ –≤—Å–µ–º–∏ final –ø–æ–ª—è–º–∏
@Slf4j  // Lombok: –¥–æ–±–∞–≤–∏—Ç –ø–æ–ª–µ log –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
public class StartCommandHandler {
    
    // Spring –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥–µ—Ç UserService –∏ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç —Å—é–¥–∞ (Dependency Injection)
    private final UserService userService;
    
    // Spring –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥–µ—Ç Bot –∏ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç —Å—é–¥–∞ (Dependency Injection)
    private final Bot bot;
    
    /**
     * –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ–º–∞–Ω–¥—É /start
     * 
     * @param update - –æ–±—ä–µ–∫—Ç Update –æ—Ç Telegram —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∫–æ–º–∞–Ω–¥–µ
     */
    public void handle(Update update) {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤ Update –µ—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
        if (!update.hasMessage()) {
            log.warn("Update –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏—è: {}", update);
            return;
        }
        
        Message message = update.getMessage();
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ–∫—Å—Ç
        if (!message.hasText()) {
            log.warn("–°–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ–∫—Å—Ç–∞: {}", message);
            return;
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç—Ç–æ –∫–æ–º–∞–Ω–¥–∞ /start
        if (!message.getText().equals("/start")) {
            log.warn("–ü–æ–ª—É—á–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –Ω–µ /start: {}", message.getText());
            return;
        }
        
        // –ò–∑–≤–ª–µ–∫–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        Long telegramId = message.getFrom().getId();
        String firstName = message.getFrom().getFirstName();
        String lastName = message.getFrom().getLastName();
        
        // –§–æ—Ä–º–∏—Ä—É–µ–º –ø–æ–ª–Ω–æ–µ –∏–º—è (–µ—Å–ª–∏ lastName null, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ firstName)
        String fullName = lastName != null 
                ? firstName + " " + lastName 
                : firstName;
        
        log.info("–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã /start –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: telegramId={}, fullName={}", 
                 telegramId, fullName);
        
        // –ü–æ–ª—É—á–∞–µ–º ID —á–∞—Ç–∞ (–∫—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –æ—Ç–≤–µ—Ç)
        Long chatId = message.getChatId();
        
        // –ü—ã—Ç–∞–µ–º—Å—è –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        try {
            // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω - registerUser –≤—ã–±—Ä–æ—Å–∏—Ç IllegalArgumentException
            userService.registerUser(telegramId, fullName);
            
            // –ï—Å–ª–∏ –¥–æ—à–ª–∏ —Å—é–¥–∞ - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω
            log.info("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω: telegramId={}", telegramId);
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            sendWelcomeMessage(chatId, fullName, true);  // true = –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
            
        } catch (IllegalArgumentException e) {
            // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω - –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞, –ø—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
            log.debug("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω: telegramId={}", telegramId);
            sendWelcomeMessage(chatId, fullName, false);  // false = —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
            
        } catch (Exception e) {
            // –°–µ—Ä—å—ë–∑–Ω–∞—è –æ—à–∏–±–∫–∞ - –ª–æ–≥–∏—Ä—É–µ–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
            log.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: telegramId={}", telegramId, e);
            sendErrorMessage(chatId);
        }
    }
    
    /**
     * –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
     * 
     * @param chatId - ID —á–∞—Ç–∞ (–∫—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å)
     * @param fullName - –ø–æ–ª–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
     * @param isNewUser - true –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–æ–≤—ã–π, false –µ—Å–ª–∏ —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω
     */
    private void sendWelcomeMessage(Long chatId, String fullName, boolean isNewUser) {
        String text;
        
        if (isNewUser) {
            text = String.format(
                "–ü—Ä–∏–≤–µ—Ç, %s! üëã\n\n" +
                "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Flower Delivery Bot!\n\n" +
                "–¢—ã —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ —Å–∏—Å—Ç–µ–º–µ.\n" +
                "–°–∫–æ—Ä–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Ç–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç –∏ –Ω–∞–∑–Ω–∞—á–∏—Ç —Ä–æ–ª—å.\n\n" +
                "–û–∂–∏–¥–∞–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏! ‚è≥",
                fullName
            );
        } else {
            text = String.format(
                "–ü—Ä–∏–≤–µ—Ç, %s! üëã\n\n" +
                "–¢—ã —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ —Å–∏—Å—Ç–µ–º–µ.\n" +
                "–û–∂–∏–¥–∞–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º! ‚è≥",
                fullName
            );
        }
        
        try {
            SendMessage message = SendMessage.builder()
                    .chatId(chatId.toString())
                    .text(text)
                    .build();
            
            bot.execute(message);
            log.info("–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: chatId={}", chatId);
            
        } catch (TelegramApiException e) {
            log.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è: chatId={}", chatId, e);
        }
    }
    
    /**
     * –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
     * 
     * @param chatId - ID —á–∞—Ç–∞ (–∫—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å)
     */
    private void sendErrorMessage(Long chatId) {
        String text = "‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏.\n\n" +
                      "–ü–æ–ø—Ä–æ–±—É–π –ø–æ–∑–∂–µ –∏–ª–∏ —Å–≤—è–∂–∏—Å—å —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º.";
        
        try {
            SendMessage message = SendMessage.builder()
                    .chatId(chatId.toString())
                    .text(text)
                    .build();
            
            bot.execute(message);
            log.info("–°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: chatId={}", chatId);
            
        } catch (TelegramApiException e) {
            log.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ: chatId={}", chatId, e);
        }
    }
}
```

---

## üîó –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï –ö BOT.JAVA

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è `StartCommandHandler`, –Ω—É–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –µ–≥–æ –∫ `Bot.java`:

```java
@Component
@RequiredArgsConstructor
public class Bot extends TelegramLongPollingBot {
    
    @Value("${telegram.bot.token}")
    private String botToken;
    
    @Value("${telegram.bot.username}")
    private String botUsername;
    
    // –ò–Ω–∂–µ–∫—Ç–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start
    private final StartCommandHandler startCommandHandler;
    
    @Override
    public void onUpdateReceived(Update update) {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ç–µ–∫—Å—Ç–æ–º
        if (update.hasMessage() && update.getMessage().hasText()) {
            String text = update.getMessage().getText();
            
            // –ï—Å–ª–∏ —ç—Ç–æ –∫–æ–º–∞–Ω–¥–∞ /start - –æ—Ç–¥–∞—ë–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫—É
            if (text.equals("/start")) {
                startCommandHandler.handle(update);
            }
            // –ó–¥–µ—Å—å –ø–æ–∑–∂–µ –¥–æ–±–∞–≤–∏–º –æ–±—Ä–∞–±–æ—Ç–∫—É –¥—Ä—É–≥–∏—Ö –∫–æ–º–∞–Ω–¥ (/help, /orders –∏ —Ç.–¥.)
        }
    }
    
    // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã
}
```

---

## üéØ –ó–ê–î–ê–ù–ò–ï –î–õ–Ø –¢–ï–ë–Ø

**–°–æ–∑–¥–∞–π —Ñ–∞–π–ª `src/main/java/org/example/flower_delivery/handler/StartCommandHandler.java` –∏ –Ω–∞–ø–∏—à–∏ —Ç—É–¥–∞ –∫–ª–∞—Å—Å!**

–ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–¥ –≤—ã—à–µ –∫–∞–∫ —à–∞–±–ª–æ–Ω, –Ω–æ:
- **–ù–µ –∫–æ–ø–∏—Ä—É–π —Å–ª–µ–ø–æ** ‚Äî –ø–æ–Ω–∏–º–∞–π –∫–∞–∂–¥—É—é —Å—Ç—Ä–æ—á–∫—É
- **–ß–∏—Ç–∞–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏** ‚Äî –æ–Ω–∏ –æ–±—ä—è—Å–Ω—è—é—Ç –∑–∞—á–µ–º –∫–∞–∂–¥—ã–π –º–µ—Ç–æ–¥
- **–ó–∞–¥–∞–≤–∞–π –≤–æ–ø—Ä–æ—Å—ã** ‚Äî –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ

–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –Ω–∞–ø–∏—à–µ—à—å ‚Äî –ø—Ä–∏—à–ª–∏ –∫–æ–¥, –∏ —è –ø—Ä–æ–≤–µ—Ä—é –µ–≥–æ!

**–ó–∞—Ç–µ–º –ø–æ–¥–∫–ª—é—á–∏ –µ–≥–æ –∫ Bot.java** ‚Äî –¥–æ–±–∞–≤—å `StartCommandHandler` –≤ `Bot.java` –∏ –≤—ã–∑–æ–≤–∏ –µ–≥–æ –≤ `onUpdateReceived()`.

---

## ‚ùì –í–û–ü–†–û–°–´ –î–õ–Ø –ü–†–û–í–ï–†–ö–ò (–ë–£–î–¨ –ì–û–¢–û–í!)

1. **–ó–∞—á–µ–º –Ω—É–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `update.hasMessage()`?** (—á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å NullPointerException, –µ—Å–ª–∏ Update –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏—è)

2. **–ü–æ—á–µ–º—É `registerUser` –º–æ–∂–µ—Ç –≤—ã–±—Ä–æ—Å–∏—Ç—å `IllegalArgumentException`?** (–µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω)

3. **–ó–∞—á–µ–º —Ä–∞–∑–¥–µ–ª—è–µ–º `sendWelcomeMessage` –∏ `sendErrorMessage` –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã?** (—á—Ç–æ–±—ã –Ω–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –∏ —Å–¥–µ–ª–∞—Ç—å –ª–æ–≥–∏–∫—É –ø–æ–Ω—è—Ç–Ω–µ–µ)

4. **–ü–æ—á–µ–º—É `chatId` –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∫–∞–∫ `chatId.toString()` –≤ `SendMessage`?** (–ø–æ—Ç–æ–º—É —á—Ç–æ `setChatId()` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç `String`, –∞ –Ω–µ `Long`)

5. **–ó–∞—á–µ–º –Ω—É–∂–µ–Ω `@Slf4j`?** (—á—Ç–æ–±—ã –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç ‚Äî –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞)

---

**–ü–∏—à–∏ –∫–æ–¥, –±–ª—è—Ç—å! –ù–µ –∫–æ–ø–∏—Ä—É–π ‚Äî –ø–æ–Ω–∏–º–∞–π!** üöÄ
